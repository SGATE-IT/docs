# 回调通知

**功能简述**

- SGate 提供了订单支付完成的通知回调，会请求对应的 Client 的接收通知 URL
- 商户需提供接收 `GET` 请求的 URL，SGate 会在成功完成支付交易后，向商户提供的 URL 发送回调通知。其中 SGate 会在URL上附加 `_orderId` 参数，参数值为订单 ID

- **时序图**

![img](../_media/callback-notification.svg)

1. 商户调用 SGate 创建订单接口创建订单
2. SGate 返回订单创建成功
3. SGate 支付交易成功
4. SGate 向商户提供的 URL 发送回调通知，通知商户支付交易成功
5. 商户调用 SGate 查询订单接口，进行订单状态确认
6. SGate 返回商户查询的订单状态
7. 商户确认订单状态无误后，返回回调通知，其中 body 为：`COMPLETED::{ORDER_ID}`
   * `{ORDER_ID}`：回调通知的订单ID
   * 样例：`COMPLETED::M448726T2022123112531745487632`

**回调通知规则**

1. 如果商户没有提供接收回调通知的 URL，则不会触发回调通知功能

2. 通知回调如果没有被正确响应，则会多次请求，规则如下：

   - 如果商户未响应回调通知，则 SGate 每隔 5 秒重试 3 次

   - 如果商户回调通知返回错误，则 SGate 每隔 15 分钟重试 1 次